<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gaitFeature • gaitFeature</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gaitFeature</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/gaitFeature.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>gaitFeature</h1>
                        <h4 class="author">Kohleth Chia</h4>
            
            <h4 class="date">2017-11-15</h4>
          </div>

    
    
<div class="contents">
<div id="preeliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preeliminaries" class="anchor"></a>Preeliminaries</h2>
<p>This is an R package so I assume you are already familiar with R.</p>
<p>Throughout this guide we will be using the dataset <code>kinematics</code> which comes with this package.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>The functions in this package assume the kinematics data is already loaded in R, in the <strong>wide</strong> format. Specifically, the kinematics <code>data.frame</code> should contain at least columns <code>curve_id</code>, <code>joint</code>, <code>plane</code>, <code>0,1,2,...,100</code>. Each row in the dataframe represent a kinematics curve on a particular joint and plane, identified by field <code>curve_id</code>, with data at 101 time points <code>0,1,2,...,100</code>.</p>
<p>The package ships with an example data <code>kinematics</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gaitFeature)
kinematics
<span class="co">#&gt; # A tibble: 180 x 106</span>
<span class="co">#&gt;    curve_id        joint  side plane   ofs      `0`      `1`      `2`</span>
<span class="co">#&gt;       &lt;int&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1        1          Pel     L   sag    49  28.1692  28.1426  28.1362</span>
<span class="co">#&gt;  2        2          Pel     R   sag    52  27.8176  27.8680  27.9559</span>
<span class="co">#&gt;  3        3          Hip     L   sag    49  52.3993  52.4592  52.6038</span>
<span class="co">#&gt;  4        4          Hip     R   sag    52  54.1121  55.2759  56.5592</span>
<span class="co">#&gt;  5        5         Knee     L   sag    49  17.1870  19.1833  21.5705</span>
<span class="co">#&gt;  6        6         Knee     R   sag    52  10.8145  13.8076  17.4061</span>
<span class="co">#&gt;  7        7        Ankle     L   sag    49  -1.9163  -1.0102   0.2010</span>
<span class="co">#&gt;  8        8        Ankle     R   sag    52  -7.2675  -7.1322  -6.3854</span>
<span class="co">#&gt;  9        9 FootProgress     L   sag    49 -95.2231 -94.2537 -93.2627</span>
<span class="co">#&gt; 10       10 FootProgress     R   sag    52 -99.2538 -97.5804 -96.0387</span>
<span class="co">#&gt; # ... with 170 more rows, and 98 more variables: `3` &lt;dbl&gt;, `4` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `5` &lt;dbl&gt;, `6` &lt;dbl&gt;, `7` &lt;dbl&gt;, `8` &lt;dbl&gt;, `9` &lt;dbl&gt;, `10` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `11` &lt;dbl&gt;, `12` &lt;dbl&gt;, `13` &lt;dbl&gt;, `14` &lt;dbl&gt;, `15` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `16` &lt;dbl&gt;, `17` &lt;dbl&gt;, `18` &lt;dbl&gt;, `19` &lt;dbl&gt;, `20` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `21` &lt;dbl&gt;, `22` &lt;dbl&gt;, `23` &lt;dbl&gt;, `24` &lt;dbl&gt;, `25` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `26` &lt;dbl&gt;, `27` &lt;dbl&gt;, `28` &lt;dbl&gt;, `29` &lt;dbl&gt;, `30` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `31` &lt;dbl&gt;, `32` &lt;dbl&gt;, `33` &lt;dbl&gt;, `34` &lt;dbl&gt;, `35` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `36` &lt;dbl&gt;, `37` &lt;dbl&gt;, `38` &lt;dbl&gt;, `39` &lt;dbl&gt;, `40` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `41` &lt;dbl&gt;, `42` &lt;dbl&gt;, `43` &lt;dbl&gt;, `44` &lt;dbl&gt;, `45` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `46` &lt;dbl&gt;, `47` &lt;dbl&gt;, `48` &lt;dbl&gt;, `49` &lt;dbl&gt;, `50` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `51` &lt;dbl&gt;, `52` &lt;dbl&gt;, `53` &lt;dbl&gt;, `54` &lt;dbl&gt;, `55` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `56` &lt;dbl&gt;, `57` &lt;dbl&gt;, `58` &lt;dbl&gt;, `59` &lt;dbl&gt;, `60` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `61` &lt;dbl&gt;, `62` &lt;dbl&gt;, `63` &lt;dbl&gt;, `64` &lt;dbl&gt;, `65` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `66` &lt;dbl&gt;, `67` &lt;dbl&gt;, `68` &lt;dbl&gt;, `69` &lt;dbl&gt;, `70` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `71` &lt;dbl&gt;, `72` &lt;dbl&gt;, `73` &lt;dbl&gt;, `74` &lt;dbl&gt;, `75` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `76` &lt;dbl&gt;, `77` &lt;dbl&gt;, `78` &lt;dbl&gt;, `79` &lt;dbl&gt;, `80` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `81` &lt;dbl&gt;, `82` &lt;dbl&gt;, `83` &lt;dbl&gt;, `84` &lt;dbl&gt;, `85` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `86` &lt;dbl&gt;, `87` &lt;dbl&gt;, `88` &lt;dbl&gt;, `89` &lt;dbl&gt;, `90` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `91` &lt;dbl&gt;, `92` &lt;dbl&gt;, `93` &lt;dbl&gt;, `94` &lt;dbl&gt;, `95` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `96` &lt;dbl&gt;, `97` &lt;dbl&gt;, `98` &lt;dbl&gt;, `99` &lt;dbl&gt;, `100` &lt;dbl&gt;</span></code></pre></div>
<p>The simplest use is to run the <code>detectAll</code> function which runs all the off-the-shelf feature detectors on the supplied dataframe.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">detected=<span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics)
detected<span class="op">%&gt;%</span><span class="kw">select</span>(<span class="op">-</span>(<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 180 x 53</span>
<span class="co">#&gt;    curve_id        joint  side plane   ofs   AIR  DblB DFdec KFxatLdec</span>
<span class="co">#&gt;       &lt;int&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1        1          Pel     L   sag    49    NA     1    NA        NA</span>
<span class="co">#&gt;  2        2          Pel     R   sag    52    NA     1    NA        NA</span>
<span class="co">#&gt;  3        3          Hip     L   sag    49    NA    NA    NA        NA</span>
<span class="co">#&gt;  4        4          Hip     R   sag    52    NA    NA    NA        NA</span>
<span class="co">#&gt;  5        5         Knee     L   sag    49    NA    NA    NA         0</span>
<span class="co">#&gt;  6        6         Knee     R   sag    52    NA    NA    NA         0</span>
<span class="co">#&gt;  7        7        Ankle     L   sag    49    NA    NA     0        NA</span>
<span class="co">#&gt;  8        8        Ankle     R   sag    52    NA    NA     0        NA</span>
<span class="co">#&gt;  9        9 FootProgress     L   sag    49    NA    NA    NA        NA</span>
<span class="co">#&gt; 10       10 FootProgress     R   sag    52    NA    NA    NA        NA</span>
<span class="co">#&gt; # ... with 170 more rows, and 44 more variables: HFxatICdec &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Tiltdec &lt;dbl&gt;, TiltdecAndROMinc &lt;dbl&gt;, PkKFxdec &lt;dbl&gt;,</span>
<span class="co">#&gt; #   DlyPkKFxdec &lt;dbl&gt;, DlyPkKFxat &lt;dbl&gt;, DlyPkKFx &lt;dbl&gt;, Desc2R &lt;dbl&gt;,</span>
<span class="co">#&gt; #   DFatSwg &lt;dbl&gt;, EPS &lt;dbl&gt;, Abd &lt;dbl&gt;, AbdatSwn &lt;dbl&gt;, Add &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FtD &lt;dbl&gt;, KFxatMSinc &lt;dbl&gt;, H2R &lt;dbl&gt;, AddatStn &lt;dbl&gt;, HER &lt;dbl&gt;,</span>
<span class="co">#&gt; #   HExtdec &lt;dbl&gt;, HypHFx &lt;dbl&gt;, HIR &lt;dbl&gt;, HypE &lt;dbl&gt;, DFinc &lt;dbl&gt;,</span>
<span class="co">#&gt; #   KFxatICinc &lt;dbl&gt;, KFxatICincAndEE &lt;dbl&gt;, HExtatMSinc &lt;dbl&gt;,</span>
<span class="co">#&gt; #   HFxinc &lt;dbl&gt;, HFxincAndROMdec &lt;dbl&gt;, HIRatLSinc &lt;dbl&gt;, MaxDFinc &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PROMinc &lt;dbl&gt;, PRotROMinc &lt;dbl&gt;, Tiltinc &lt;dbl&gt;,</span>
<span class="co">#&gt; #   TiltincAndROMinc &lt;dbl&gt;, PFinc &lt;dbl&gt;, PkKFxat &lt;dbl&gt;, In &lt;dbl&gt;,</span>
<span class="co">#&gt; #   iPP &lt;dbl&gt;, N1R &lt;dbl&gt;, Out &lt;dbl&gt;, ElevOrDep &lt;dbl&gt;, ProOrRe &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PrevROM &lt;dbl&gt;, S2R &lt;dbl&gt;</span></code></pre></div>
<p>Notice that packages <code>dplyr</code>, and <code>tidyr</code> are loaded by default when this package is loaded.</p>
<p><code>detectAll</code> returns the same data.frame as what is supplied, with extra columns – one for each feature. If the feature column is <code>NA</code>, it means that feature is not applicable to that curve (e.g. Ankle Internal Rotation (AIR) not relevant for the Pelvis curve.) If the field is <code>1</code> then that feature is detected, and <code>0</code> indicates the contrary.</p>
<p>The list of feature detectors that are called by <code>detectAll</code> is specified through the <code>fDict</code> argument. This argument should be a data.frame with column <code>fn</code> which list the names of the detectors to be called. Furthermore, it can have columns <code>joint</code> and <code>plane</code> which indicates which joint and plane a particular detector is related to. If <code>fDict=NULL</code> (default), it is generated on the spot by the <code>makeFDict</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/makeFDict.html">makeFDict</a></span>()
<span class="co">#&gt; # A tibble: 48 x 5</span>
<span class="co">#&gt;                     fn joint plane            fname</span>
<span class="co">#&gt;                  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;</span>
<span class="co">#&gt;  1              .dtAIR Ankle   tra              AIR</span>
<span class="co">#&gt;  2          .dtDblBump   Pel   sag             DblB</span>
<span class="co">#&gt;  3            .dtDecDF Ankle   sag            DFdec</span>
<span class="co">#&gt;  4     .dtDecFxLoading  Knee   sag        KFxatLdec</span>
<span class="co">#&gt;  5       .dtDecHipFxIC   Hip   sag       HFxatICdec</span>
<span class="co">#&gt;  6       .dtDecPelTilt   Pel   sag          Tiltdec</span>
<span class="co">#&gt;  7 .dtDecPelTiltIncROM   Pel   sag TiltdecAndROMinc</span>
<span class="co">#&gt;  8        .dtDecPkKnFx  Knee   sag         PkKFxdec</span>
<span class="co">#&gt;  9   .dtDelayDecPkKnFx  Knee   sag      DlyPkKFxdec</span>
<span class="co">#&gt; 10   .dtDelayIncPkKnFx  Knee   sag       DlyPkKFxat</span>
<span class="co">#&gt; # ... with 38 more rows, and 1 more variables: featurename &lt;chr&gt;</span></code></pre></div>
<p>If you are only interested at features that are a particular joint or plane, you can specify that in the <code>detectAll</code> call. But make sure the joint and plane value appears in the <code>fDict</code> data.frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics, <span class="dt">joint=</span><span class="st">"Hip"</span>, <span class="dt">plane=</span><span class="st">"sag"</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 180 x 11</span>
<span class="co">#&gt;    curve_id        joint  side plane   ofs HFxatICdec HExtdec HypHFx</span>
<span class="co">#&gt;       &lt;int&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1        1          Pel     L   sag    49         NA      NA     NA</span>
<span class="co">#&gt;  2        2          Pel     R   sag    52         NA      NA     NA</span>
<span class="co">#&gt;  3        3          Hip     L   sag    49          0       0      0</span>
<span class="co">#&gt;  4        4          Hip     R   sag    52          0       0      0</span>
<span class="co">#&gt;  5        5         Knee     L   sag    49         NA      NA     NA</span>
<span class="co">#&gt;  6        6         Knee     R   sag    52         NA      NA     NA</span>
<span class="co">#&gt;  7        7        Ankle     L   sag    49         NA      NA     NA</span>
<span class="co">#&gt;  8        8        Ankle     R   sag    52         NA      NA     NA</span>
<span class="co">#&gt;  9        9 FootProgress     L   sag    49         NA      NA     NA</span>
<span class="co">#&gt; 10       10 FootProgress     R   sag    52         NA      NA     NA</span>
<span class="co">#&gt; # ... with 170 more rows, and 3 more variables: HExtatMSinc &lt;dbl&gt;,</span>
<span class="co">#&gt; #   HFxinc &lt;dbl&gt;, HFxincAndROMdec &lt;dbl&gt;</span></code></pre></div>
<p>Note that all of <code>kinematics</code> will still be returned. So the above result is different to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics<span class="op">%&gt;%</span>
<span class="st">            </span><span class="kw">filter</span>(joint<span class="op">==</span><span class="st">"Hip"</span>,plane<span class="op">==</span><span class="st">"sag"</span>),<span class="dt">joint=</span><span class="st">"Hip"</span>,<span class="dt">plane=</span><span class="st">"sag"</span>)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 12 x 11</span>
<span class="co">#&gt;    curve_id joint  side plane   ofs HFxatICdec HExtdec HypHFx HExtatMSinc</span>
<span class="co">#&gt;       &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1        3   Hip     L   sag    49          0       0      0           0</span>
<span class="co">#&gt;  2        4   Hip     R   sag    52          0       0      0           0</span>
<span class="co">#&gt;  3       33   Hip     L   sag    48          0       0      0           0</span>
<span class="co">#&gt;  4       34   Hip     R   sag    54          0       0      0           0</span>
<span class="co">#&gt;  5       63   Hip     L   sag    50          0       0      0           0</span>
<span class="co">#&gt;  6       64   Hip     R   sag    49          0       0      0           0</span>
<span class="co">#&gt;  7       93   Hip     L   sag    50          0       0      0           0</span>
<span class="co">#&gt;  8       94   Hip     R   sag    50          0       0      0           0</span>
<span class="co">#&gt;  9      123   Hip     L   sag    50          0       0      0           0</span>
<span class="co">#&gt; 10      124   Hip     R   sag    51          0       0      0           0</span>
<span class="co">#&gt; 11      153   Hip     L   sag    50          0       0      0           0</span>
<span class="co">#&gt; 12      154   Hip     R   sag    49          0       0      0           0</span>
<span class="co">#&gt; # ... with 2 more variables: HFxinc &lt;dbl&gt;, HFxincAndROMdec &lt;dbl&gt;</span></code></pre></div>
<p>A (more) detailed explanation of why each feature is detected or not can be returned by setting <code><a href="../reference/detectAll.html">detectAll(...,comp=TRUE)</a></code> and inspecting the attributes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z=<span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics,<span class="dt">joint=</span><span class="st">"Hip"</span>,<span class="dt">plane=</span><span class="st">"sag"</span>,<span class="dt">comp=</span><span class="ot">TRUE</span>)
<span class="kw">head</span>(<span class="kw">attr</span>(z,<span class="st">"comp"</span>),<span class="dv">1</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; # A tibble: 12 x 3</span>
<span class="co">#&gt;    curve_id `Cl:c(0)&lt;2sd` HFxatICdec</span>
<span class="co">#&gt;       &lt;int&gt;         &lt;lgl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1        3         FALSE          0</span>
<span class="co">#&gt;  2        4         FALSE          0</span>
<span class="co">#&gt;  3       33         FALSE          0</span>
<span class="co">#&gt;  4       34         FALSE          0</span>
<span class="co">#&gt;  5       63         FALSE          0</span>
<span class="co">#&gt;  6       64         FALSE          0</span>
<span class="co">#&gt;  7       93         FALSE          0</span>
<span class="co">#&gt;  8       94         FALSE          0</span>
<span class="co">#&gt;  9      123         FALSE          0</span>
<span class="co">#&gt; 10      124         FALSE          0</span>
<span class="co">#&gt; 11      153         FALSE          0</span>
<span class="co">#&gt; 12      154         FALSE          0</span></code></pre></div>
<p><code>attr(.,"comp")</code> returns one dataframe for each feature. The columns that begin with <code>Cl:</code> indicates it is a clause (component) of the feature. All clauses must be <code>TRUE</code> for a feature to be detected.</p>
<p>You can also call the individual detector directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/definitions.html">.dtDecHipFxIC</a></span>(kinematics)
<span class="co">#&gt; # A tibble: 12 x 3</span>
<span class="co">#&gt;    curve_id `Cl:c(0)&lt;2sd` HFxatICdec</span>
<span class="co">#&gt;       &lt;int&gt;         &lt;lgl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1        3         FALSE          0</span>
<span class="co">#&gt;  2        4         FALSE          0</span>
<span class="co">#&gt;  3       33         FALSE          0</span>
<span class="co">#&gt;  4       34         FALSE          0</span>
<span class="co">#&gt;  5       63         FALSE          0</span>
<span class="co">#&gt;  6       64         FALSE          0</span>
<span class="co">#&gt;  7       93         FALSE          0</span>
<span class="co">#&gt;  8       94         FALSE          0</span>
<span class="co">#&gt;  9      123         FALSE          0</span>
<span class="co">#&gt; 10      124         FALSE          0</span>
<span class="co">#&gt; 11      153         FALSE          0</span>
<span class="co">#&gt; 12      154         FALSE          0</span></code></pre></div>
</div>
<div id="constructing-your-own-feature-detector" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-your-own-feature-detector" class="anchor"></a>Constructing your own feature detector</h2>
<p>Although the package ships with its own set of feature detectors. It is actually not that difficult to incorporate your own. All the shipped feature detectors are functions whose name starts with <code>.dt</code>. See <code><a href="../reference/definitions.html">?definitions</a></code>.</p>
<div id="a-naive-example" class="section level3">
<h3 class="hasAnchor">
<a href="#a-naive-example" class="anchor"></a>A naive example</h3>
<p>In principle, feature detectors are just functions which take a data.frame and return another with columns <code>curve_id</code>, <code>Cl:xxx</code>, and <code>fname</code>, where <code>Cl:xxx</code> is the clause component of the feature definition, and <code>fname</code> is the machine-friendly feature name. So, for example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myRandomDetector=<span class="cf">function</span>(x){
  detected=<span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,<span class="kw">nrow</span>(x),<span class="ot">TRUE</span>)
  <span class="kw">data_frame</span>(<span class="dt">curve_id=</span>x<span class="op">$</span>curve_id,
             <span class="st">"Cl:random"</span>=<span class="kw">as.logical</span>(detected),
             <span class="dt">Random=</span>detected)
}

<span class="kw">myRandomDetector</span>(kinematics)
<span class="co">#&gt; # A tibble: 180 x 3</span>
<span class="co">#&gt;    curve_id `Cl:random` Random</span>
<span class="co">#&gt;       &lt;int&gt;       &lt;lgl&gt;  &lt;int&gt;</span>
<span class="co">#&gt;  1        1       FALSE      0</span>
<span class="co">#&gt;  2        2        TRUE      1</span>
<span class="co">#&gt;  3        3        TRUE      1</span>
<span class="co">#&gt;  4        4        TRUE      1</span>
<span class="co">#&gt;  5        5       FALSE      0</span>
<span class="co">#&gt;  6        6       FALSE      0</span>
<span class="co">#&gt;  7        7        TRUE      1</span>
<span class="co">#&gt;  8        8        TRUE      1</span>
<span class="co">#&gt;  9        9       FALSE      0</span>
<span class="co">#&gt; 10       10        TRUE      1</span>
<span class="co">#&gt; # ... with 170 more rows</span></code></pre></div>
<p>And you can use the <code>detectAll</code> function with it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics,<span class="dt">fDict=</span><span class="kw">data.frame</span>(<span class="dt">fn=</span><span class="st">"myRandomDetector"</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 180 x 6</span>
<span class="co">#&gt;    curve_id        joint  side plane   ofs Random</span>
<span class="co">#&gt;       &lt;int&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">#&gt;  1        1          Pel     L   sag    49      1</span>
<span class="co">#&gt;  2        2          Pel     R   sag    52      1</span>
<span class="co">#&gt;  3        3          Hip     L   sag    49      0</span>
<span class="co">#&gt;  4        4          Hip     R   sag    52      1</span>
<span class="co">#&gt;  5        5         Knee     L   sag    49      0</span>
<span class="co">#&gt;  6        6         Knee     R   sag    52      1</span>
<span class="co">#&gt;  7        7        Ankle     L   sag    49      0</span>
<span class="co">#&gt;  8        8        Ankle     R   sag    52      1</span>
<span class="co">#&gt;  9        9 FootProgress     L   sag    49      1</span>
<span class="co">#&gt; 10       10 FootProgress     R   sag    52      0</span>
<span class="co">#&gt; # ... with 170 more rows</span></code></pre></div>
<p>If you want to use the <code>joint</code> and <code>plane</code> filter in <code>detectAll</code>, then you need to include those in the feature dictionary <code>fDict</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myRandomDetector2=<span class="cf">function</span>(x){
  x=<span class="kw">filter</span>(x,joint<span class="op">==</span><span class="st">"Knee"</span>,plane<span class="op">==</span><span class="st">"sag"</span>)
  <span class="kw">myRandomDetector</span>(x)
}
<span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics,<span class="dt">plane=</span><span class="st">"sag"</span>,<span class="dt">fDict=</span><span class="kw">data_frame</span>(<span class="dt">joint=</span><span class="st">"Knee"</span>,<span class="dt">plane=</span><span class="st">"sag"</span>,<span class="dt">fn=</span><span class="st">"myRandomDetector2"</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 180 x 6</span>
<span class="co">#&gt;    curve_id        joint  side plane   ofs Random</span>
<span class="co">#&gt;       &lt;int&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">#&gt;  1        1          Pel     L   sag    49     NA</span>
<span class="co">#&gt;  2        2          Pel     R   sag    52     NA</span>
<span class="co">#&gt;  3        3          Hip     L   sag    49     NA</span>
<span class="co">#&gt;  4        4          Hip     R   sag    52     NA</span>
<span class="co">#&gt;  5        5         Knee     L   sag    49      0</span>
<span class="co">#&gt;  6        6         Knee     R   sag    52      1</span>
<span class="co">#&gt;  7        7        Ankle     L   sag    49     NA</span>
<span class="co">#&gt;  8        8        Ankle     R   sag    52     NA</span>
<span class="co">#&gt;  9        9 FootProgress     L   sag    49     NA</span>
<span class="co">#&gt; 10       10 FootProgress     R   sag    52     NA</span>
<span class="co">#&gt; # ... with 170 more rows</span>

## use a list of feature detectors.
oldfDict=<span class="kw"><a href="../reference/makeFDict.html">makeFDict</a></span>()<span class="op">%&gt;%</span><span class="kw">filter</span>(joint<span class="op">==</span><span class="st">"Knee"</span>,plane<span class="op">==</span><span class="st">"sag"</span>)
fDict=<span class="kw">rbind</span>(oldfDict,
            <span class="kw">data_frame</span>(<span class="dt">joint=</span><span class="st">"Knee"</span>,
                       <span class="dt">plane=</span><span class="st">"sag"</span>,
                       <span class="dt">fn=</span><span class="st">"myRandomDetector2"</span>,
                       <span class="dt">fname=</span><span class="st">"Rnd"</span>,
                       <span class="dt">featurename=</span><span class="st">"Silly Random Feature"</span>))
<span class="kw"><a href="../reference/detectAll.html">detectAll</a></span>(kinematics,
          <span class="dt">plane=</span><span class="st">"sag"</span>,
          <span class="dt">joint=</span><span class="st">"Knee"</span>,
          <span class="dt">fDict=</span>fDict)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>(<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>))
<span class="co">#&gt; # A tibble: 180 x 16</span>
<span class="co">#&gt;    curve_id        joint  side plane   ofs KFxatLdec PkKFxdec DlyPkKFxdec</span>
<span class="co">#&gt;       &lt;int&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1        1          Pel     L   sag    49        NA       NA          NA</span>
<span class="co">#&gt;  2        2          Pel     R   sag    52        NA       NA          NA</span>
<span class="co">#&gt;  3        3          Hip     L   sag    49        NA       NA          NA</span>
<span class="co">#&gt;  4        4          Hip     R   sag    52        NA       NA          NA</span>
<span class="co">#&gt;  5        5         Knee     L   sag    49         0        0           0</span>
<span class="co">#&gt;  6        6         Knee     R   sag    52         0        0           0</span>
<span class="co">#&gt;  7        7        Ankle     L   sag    49        NA       NA          NA</span>
<span class="co">#&gt;  8        8        Ankle     R   sag    52        NA       NA          NA</span>
<span class="co">#&gt;  9        9 FootProgress     L   sag    49        NA       NA          NA</span>
<span class="co">#&gt; 10       10 FootProgress     R   sag    52        NA       NA          NA</span>
<span class="co">#&gt; # ... with 170 more rows, and 8 more variables: DlyPkKFxat &lt;dbl&gt;,</span>
<span class="co">#&gt; #   DlyPkKFx &lt;dbl&gt;, KFxatMSinc &lt;dbl&gt;, HypE &lt;dbl&gt;, KFxatICinc &lt;dbl&gt;,</span>
<span class="co">#&gt; #   KFxatICincAndEE &lt;dbl&gt;, PkKFxat &lt;dbl&gt;, Random &lt;int&gt;</span></code></pre></div>
</div>
<div id="a-realistic-example" class="section level3">
<h3 class="hasAnchor">
<a href="#a-realistic-example" class="anchor"></a>A realistic example</h3>
<p>However, a useful feature detector will probably be more sophisticated than that. And this package provides some useful tool to construct these complicated features. But these tools assume a particular way of constructing feature detectors. In particular, a feature detector function should consist of 3 components: 1. A filter to a specific joint and plane. 2. One or more clauses. 3. A finish function.</p>
<div id="filter" class="section level4">
<h4 class="hasAnchor">
<a href="#filter" class="anchor"></a>1. Filter</h4>
<p>A feature should only apply to a particular joint and plane, so we recommend that you explicitly incorporate a filter in the definition.</p>
</div>
<div id="clauses" class="section level4">
<h4 class="hasAnchor">
<a href="#clauses" class="anchor"></a>2. Clauses</h4>
<p>A feature definition should consists of one or more <em>clauses</em>. The most commonly used clause is what we called a <em>univariate statistics clauses</em>.</p>
<p>And it works as followed: 1. From a curve select a time domain 2. Compute a summary statistics on the selected curve segment. 3. Compute the same statistics on each of the reference curve (for typically developed children) 4. If the statistics computed in 2. is extreme* compared to the set of statistics computed in 3., the clause is passed.</p>
<p>*The definition of extreme is user-definable. For example, it can be &gt; mean + 2 standard deviation.</p>
<p>This clause is implemented in the function <code>unistat</code>. See <code><a href="../reference/unistat.html">?unistat</a></code>. For example <code><a href="../reference/unistat.html">unistat(x,`60`:`100`, .f=mean, .dir="&gt;", .k=2)</a></code> reads the mean angle at t%in%[60,100] should be greater than mean + 2SD of the same mean copmuted from the typical reference data.</p>
<p><code>.f</code> can be any function which returns a single number statistics. See <code><a href="../reference/clauseFn.html">?.tp</a></code> for commonly used functions that ships with this package.</p>
<p>The possible directions <code>.dir</code> are: <code>&gt;(=)</code>, <code>&lt;(=)</code>, <code>%w%</code>, and <code>%o%</code>, where the last two stands for ‘within’ and ‘outside’.</p>
<p>An absolute threshold can be specified by using the <code>.c=xxx</code> argument instead of <code>.k=xx</code>.</p>
</div>
<div id="finish-with-finish" class="section level4">
<h4 class="hasAnchor">
<a href="#finish-with-finish" class="anchor"></a>3. Finish with <code>finish</code>
</h4>
<p>A feature detector function should finish off with the <code>finish</code> function, which does several house-keeping functions, such as checking all clauses are passed before the feature is deemed present, and setting various attributes appropriately.</p>
</div>
<div id="example" class="section level4">
<h4 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h4>
<p>If we look at the detector for increased ankle rotation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">.dtAIR
<span class="co">#&gt; function(df){</span>
<span class="co">#&gt;   df%&gt;%</span>
<span class="co">#&gt;     filter(joint=="Ankle"&amp;plane=="tra")%&gt;%</span>
<span class="co">#&gt;     unistat(`0`:`60`,.f=mean,.dir="&gt;")%&gt;%</span>
<span class="co">#&gt;     finish(featurename = "Ankle Internal Rotation",fname = "AIR")</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;environment: namespace:gaitFeature&gt;</span></code></pre></div>
<p>We will see that,</p>
<ol style="list-style-type: decimal">
<li>it is a feature which applies to the Ankle on the transverse plane.</li>
<li>There is one clause, which reads the mean angle at t%in%[60,100] should be greater than mean + 2SD (default) of the same mean copmuted from the typical reference data.</li>
<li>The machine-friendly name for this feature is ‘AIR’, and the human interpretable name is ‘Ankle Internal Rotation’.</li>
</ol>
</div>
</div>
<div id="multiple-clauses" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-clauses" class="anchor"></a>Multiple clauses</h3>
<p>Multiple clauses can be chained together by the pipe <code>%&gt;%</code> operator. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">.dtDecPelTiltIncROM
<span class="co">#&gt; function(df){</span>
<span class="co">#&gt;   df%&gt;%</span>
<span class="co">#&gt;     filter(joint=="Pel"&amp;plane=="sag")%&gt;%</span>
<span class="co">#&gt;     unistat(`0`:`100`,.f=mean,.dir="&lt;")%&gt;%</span>
<span class="co">#&gt;     unistat(`0`:`100`,.f=.ROM,.dir="&gt;",k=2)%&gt;%</span>
<span class="co">#&gt;     finish(featurename = "Decreased Pelvic Tilt + \n Increased ROM",fname = "TiltdecAndROMinc")</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;environment: namespace:gaitFeature&gt;</span></code></pre></div>
<p>has 2 clauses.</p>
</div>
<div id="other-clauses" class="section level3">
<h3 class="hasAnchor">
<a href="#other-clauses" class="anchor"></a>Other clauses</h3>
<p>In addition to <code>unistat</code>, we provide two more clause functions: <code>corr</code> and <code>custom</code>. These clauses become useful when the feature is difficult to define through <code>unistat</code>.</p>
<div id="correlation-clause-corr" class="section level4">
<h4 class="hasAnchor">
<a href="#correlation-clause-corr" class="anchor"></a>Correlation clause <code>corr</code>
</h4>
<p>A correlation clause works as follow:</p>
<ol style="list-style-type: decimal">
<li>From a curve select a time domain.</li>
<li>Correlate that curve segment with a set of pre-supplied target curves.</li>
<li>If any of the correlation meets the target threshold the clause is passed</li>
</ol>
<p>Therefore, in order to use this clause, a set of target curves needs to be supplied (using the <code><a href="../reference/unistat.html">corr(..., TC=x,...)</a></code>).</p>
<p>This package ships with 5 sets of target curves, which can be assessed by the <code><a href="../reference/rc.html">.tc()</a></code> function. They are: <code>.tc()$ett</code>, <code>.tc()$uni</code>, <code>.tc()$s2r</code>, <code>.tc()$revrom</code>, and <code>.tc()$dblbump</code>, which are target curves for ‘External Tibial Torsion’, ‘Uni Bump’, ‘Short 2nd rocker’, ‘Reverse ROM’, and ‘Double Bump’.</p>
<p>Since all these curves have domain 0:100, the same domain should be specified in the <code>corr</code> function.</p>
<p>Straightly speaking, we could use the <code>unistat</code> clause to achieve the same result. That is,</p>
<p><code><a href="../reference/unistat.html">corr(...,TC=x,"&gt;=",0.8)</a></code> is equivalent to</p>
<p><code><a href="../reference/unistat.html">unistat(`0`:`100`,.f=function(x)max(apply(t(.tc()$dblbump),2,cor,x)),.dir="&gt;=",.c=0.8)</a></code></p>
<p>(the <code>apply</code> function is only needed because we have a set of <code>TC</code>. Otherwise a simple <code>cor</code> will suffice.)</p>
<p>However, the <code>corr</code> clause is just more literal and thus easier to interpret.</p>
</div>
<div id="custom-clause-custom" class="section level4">
<h4 class="hasAnchor">
<a href="#custom-clause-custom" class="anchor"></a>Custom clause <code>custom</code>
</h4>
<p>The custom clause function <code>custom</code> allows one to supply a custom condition through as a string <code><a href="../reference/unistat.html">custom(...,cond)</a></code>. It is particularly useful for clauses that require data other than the kinematics, such as timing related clauses. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">.dtDelayPkKnFx
<span class="co">#&gt; function(df){</span>
<span class="co">#&gt;   df%&gt;%</span>
<span class="co">#&gt;     filter(joint=="Knee"&amp;plane=="sag")%&gt;%</span>
<span class="co">#&gt;     custom(`60`:`100`,cond="t[which.max(angle)]&gt;75")%&gt;%</span>
<span class="co">#&gt;     finish(featurename = "Delayed Peak Knee Flexion",fname = "DlyPkKFx")</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;environment: namespace:gaitFeature&gt;</span></code></pre></div>
<p>has a clause which says the peak angle after <code>t=60</code> must occur after <code>t=75</code>.</p>
<p>Again, straightly speaking, this clause can be expressed as a univariate clause. That is,</p>
<p><code><a href="../reference/unistat.html">custom(`60`:`100`, cond="t[which.max(angle)]&gt;75")</a></code></p>
<p>is equivalent to</p>
<p><code><a href="../reference/unistat.html">unistat(`60`:`100`,.f=function(x)which.max(x),.dir="&gt;",.c=75-60+1)</a></code>.</p>
<p>However, the <code>unistat</code> version relies on the assumption that <code>x</code> in <code>.f</code> is sorted inn <code>t</code>, whereas <code>custom</code> is explicitly extracting <code>t</code>.</p>
</div>
</div>
</div>
<div id="resampling" class="section level2">
<h2 class="hasAnchor">
<a href="#resampling" class="anchor"></a>Resampling</h2>
<p>All functions in this package assume the kinematics curves are sampled at 101 time points. If this is not the case, there is a sampling function <code><a href="../reference/resamp101.html">?resamp101</a></code> which fits a periodic cubic spline to your existing curves, and then resample the 101 times points from it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## x is a coarser version of kinematics
x=kinematics<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(curve_id,<span class="st">`</span><span class="dt">0</span><span class="st">`</span>,<span class="st">`</span><span class="dt">10</span><span class="st">`</span>,<span class="st">`</span><span class="dt">20</span><span class="st">`</span>,<span class="st">`</span><span class="dt">30</span><span class="st">`</span>,<span class="st">`</span><span class="dt">40</span><span class="st">`</span>,<span class="st">`</span><span class="dt">50</span><span class="st">`</span>,<span class="st">`</span><span class="dt">60</span><span class="st">`</span>,<span class="st">`</span><span class="dt">70</span><span class="st">`</span>,<span class="st">`</span><span class="dt">80</span><span class="st">`</span>,<span class="st">`</span><span class="dt">90</span><span class="st">`</span>,<span class="st">`</span><span class="dt">100</span><span class="st">`</span>)

y=<span class="kw"><a href="../reference/resamp101.html">resamp101</a></span>(x,<span class="st">`</span><span class="dt">0</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">100</span><span class="st">`</span>,<span class="dt">plot=</span>T)</code></pre></div>
<p><img src="gaitFeature_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>The <code>plot=T</code> argument plots the interpolated lines together with the observed points. It is recommended that you leave it as <code>FALSE</code> (default) if you are resampling many curves, because the plot will just be cluttered.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#preeliminaries">Preeliminaries</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#quick-start">Quick Start</a></li>
      <li><a href="#constructing-your-own-feature-detector">Constructing your own feature detector</a></li>
      <li><a href="#resampling">Resampling</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kohleth Chia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
